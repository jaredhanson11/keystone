# This manifest maps deployment payload -> stacks to deploy
#
## Deploys Structure ##
# deploys/
#   manifest.yaml
#   <namespace>/
#     <app>.yml # stack = _default
#     <app>.<stack>.yml
#
# Manifest Entry #
# <payload.deploy>:
#   - name: str # used to find
#     chartName: str # name of chart in helm repo (i.e stable/postgres)
#     namespace: str # name of k8s namespace (and values file directory)
#     stacks: list # if empty deploy all stacks, else deploy only stacks defined here
#
# NO YAML ANCHORS ALLOWED -> https://github.com/mikefarah/yq/issues/339

endergy-master: []

# tools
py-repo:
  - name: "py-repo"
    chartName: "vamble/py-repo"
    namespace: "tools"
    stacks: []

helm-repo:
  - name: "helm-repo"
    chartName: "vamble/helm-repo"
    namespace: "tools"
    stacks: []

# common
postgresql:
  # Installed with:
  #   --set existingSecret=postgres-secrets
  - name: "postgresql"
    chartName: "stable/postgresql"
    namespace: "common"
    stacks: []

# development

## Summn
summn-landing-page-staging:
  - name: "summn-landing-page"
    chartName: "vamble/landing-page"
    namespace: "development"
    stacks: []

summn-api-staging:
  - name: "summn-api-prototype"
    chartName: "vamble/flask-app"
    namespace: "development"
    stacks: []

summn-story-retriever-staging:
  - name: "summn-story-retriever"
    chartName: "vamble/simple-job"
    namespace: "development"
    stacks: []

summn-admin-web-staging:
  - name: "summn-admin-web"
    chartName: "vamble/webclient-app"
    namespace: "development"
    stacks: []

summn-push-engine-staging:
  - name: "summn-push-engine"
    chartName: "vamble/rmq-worker"
    namespace: "development"
    stacks: []

summn-push-scheduler-staging:
  - name: "summn-push-scheduler"
    chartName: "vamble/simple-job"
    namespace: "development"
    stacks: []

summn-email-engine-staging:
  - name: "summn-email-engine"
    chartName: "vamble/rmq-worker"
    namespace: "development"
    stacks: []

rabbitmq-staging:
  - name: "rabbitmq"
    chartName: "bitnami/rabbitmq"
    namespace: "development"
    stacks: []

summn-support-web-staging:
  - name: "summn-support-web"
    chartName: "vamble/webclient-app"
    namespace: "development"
    stacks: []

# Production
rabbitmq-prod:
  - name: "rabbitmq"
    chartName: "bitnami/rabbitmq"
    namespace: "production"
    stacks: []

summn-landing-page-prod:
  - name: "summn-landing-page"
    chartName: "vamble/landing-page"
    namespace: "production"
    stacks: []

summn-api-prod:
  - name: "summn-api-prototype"
    chartName: "vamble/flask-app"
    namespace: "production"
    stacks: []

summn-story-retriever-prod:
  - name: "summn-story-retriever"
    chartName: "vamble/simple-job"
    namespace: "production"
    stacks: []

summn-admin-web-prod:
  - name: "summn-admin-web"
    chartName: "vamble/webclient-app"
    namespace: "production"
    stacks: []

summn-push-engine-prod:
  - name: "summn-push-engine"
    chartName: "vamble/rmq-worker"
    namespace: "production"
    stacks: []

summn-push-scheduler-prod:
  - name: "summn-push-scheduler"
    chartName: "vamble/simple-job"
    namespace: "production"
    stacks: []

summn-email-engine-prod:
  - name: "summn-email-engine"
    chartName: "vamble/rmq-worker"
    namespace: "production"
    stacks: []

summn-support-web-prod:
  - name: "summn-support-web"
    chartName: "vamble/webclient-app"
    namespace: "production"
    stacks: []
