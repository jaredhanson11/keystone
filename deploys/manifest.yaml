# This manifest maps deployment payload -> stacks to deploy
#
## Deploys Structure ##
# deploys/
#   manifest.yaml
#   <namespace>/
#     <app>.yaml # stack = _default
#     <app>.yaml
#
## Manifest Entry ##
# <payload.deploy>:
#   - name: str # used to find
#     chartName: str # name of chart in helm repo (i.e stable/postgres)
#     namespace: str # name of k8s namespace (and values file directory)
#
## Result ##
#   each Manifest Entry is installed via Helm
#     using the <chartName> specified,
#     the values located at deploys/<namespace>/<name>.yaml,
#     and the helm deployment name as <payload.key>
#
# NO YAML ANCHORS ALLOWED -> https://github.com/mikefarah/yq/issues/339

## Nexus (artifacts)
nexus:
  - name: "nexus"
    chartName: "sonatype/nexus-repository-manager"
    namespace: "nexus"

## Ghost (blog)
ghost:
  - name: "ghost"
    chartName: "local/ghost"
    namespace: "ghost"

## Flok
#### Production
flok-landing-page-prod:
  - name: "flok-landing-page"
    chartName: "local/webclient-app"
    namespace: "production"

algolia-indexer-producer:
  - name: "algolia-indexer-server"
    chartName: "local/flask-app"
    namespace: "production"

algolia-indexer-consumer:
  - name: "algolia-indexer"
    chartName: "local/rmq-worker"
    namespace: "production"

flok-admin-prod:
  - name: "flok-admin"
    chartName: "local/flask-app"
    namespace: "production"

#### Staging
hawk-staging:
  - name: "hawk"
    chartName: "local/flask-app"
    namespace: "staging"

flok-flight-receipts-web-staging:
  - name: "flok-flight-receipts-web"
    chartName: "local/flask-app"
    namespace: "staging"

flok-flight-receipts-rmq-worker-staging:
  - name: "flok-flight-receipts-rmq-worker"
    chartName: "local/rmq-worker"
    namespace: "staging"

flok-staging:
  - name: "flok"
    chartName: "local/webclient-app"
    namespace: "staging"

flok-admin-staging:
  - name: "flok-admin"
    chartName: "local/flask-app"
    namespace: "staging"

# Used when needing to test landing page changes ##
flok-landing-page-staging:
  - name: "flok-landing-page"
    chartName: "local/webclient-app"
    namespace: "staging"
