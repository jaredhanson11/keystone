# This manifest maps deployment payload -> stacks to deploy
#
## Deploys Structure ##
# deploys/
#   manifest.yaml
#   <namespace>/
#     <app>.yml # stack = _default
#     <app>.<stack>.yml
#
# Manifest Entry #
# <payload.deploy>:
#   - name: str # used to find
#     chartName: str # name of chart in helm repo (i.e stable/postgres)
#     namespace: str # name of k8s namespace (and values file directory)
#     stacks: list # if empty deploy all stacks, else deploy only stacks defined here
#
# NO YAML ANCHORS ALLOWED -> https://github.com/mikefarah/yq/issues/339

endergy-master: []

# tools
py-repo:
  - name: "py-repo"
    chartName: "vamble/py-repo"
    namespace: "tools"
    stacks: []

helm-repo:
  - name: "helm-repo"
    chartName: "vamble/helm-repo"
    namespace: "tools"
    stacks: []

# common services
db-migrations:
  - name: "db-migrations"
    chartName: "vamble/db-migrations"
    namespace: "common"
    stacks: []

postgresql:
  # Installed with:
  #   --set existingSecret=postgres-secrets
  - name: "postgresql"
    chartName: "stable/postgresql"
    namespace: "common"
    stacks: []

rabbitmq:
  # Installed with:
  #   --set rabbitmq.password=***
  - name: "rabbitmq"
    chartName: "stable/rabbitmq"
    namespace: "common"
    stacks: []

minio:
  # Installed with:
  #   --set accessKey=***
  #   --set secretKey=***
  - name: "minio"
    chartName: "stable/minio"
    namespace: "common"
    stacks: []

# apps

## STREAMT -- DEPRECATED ##
streamt-api:
  - name: "streamt-api"
    chartName: "vamble/streamt-app"
    namespace: "development"
    stacks: []

streamt-vidpub:
  - name: "streamt-vidpub"
    chartName: "vamble/streamt-vidpub"
    namespace: "development"
    stacks: []

## Summn
summn-landing-page:
  - name: "summn-landing-page"
    chartName: "vamble/landing-page"
    namespace: "development"
    stacks: []

summn-api-prototype:
  - name: "summn-api-prototype"
    chartName: "vamble/flask-app"
    namespace: "development"
    stacks: []

summn-admin-prototype:
  - name: "summn-admin-prototype"
    chartName: "vamble/webclient-app"
    namespace: "development"
    stacks: []
