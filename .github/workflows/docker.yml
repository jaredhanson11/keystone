name: Docker Image CI
on: [push]
jobs:
  docker-publish:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v1
    - name: Build and publish docker image
      uses: docker://jaredhanson11/cicd-tools
      env:
        DOCKER_USER: ${{ secrets.DOCKER_USER }}
        DOCKER_PASS: ${{ secrets.DOCKER_PASS }}
      with:
        entrypoint: /scripts/github-workflows/push-docker-artifacts.sh
    - name: Trigger deployment
      uses: docker://jaredhanson11/cicd-tools
      env:
        GITHUB_KEY: ${{ secrets.JAREDHANSON11_ACCESS_KEY }}
        GITHUB_USER: jaredhanson11
        GITHUB_REPO: keystone
      with:
        entrypoint: /scripts/github-workflows/trigger-deploy.sh
